<polymer-element name="esis-datastore">
	<script>
		Polymer('esis-datastore', {
			// is this an existing dataset
			editMode : false,
			// existing package id
			package_id : '',

			// information about exsiting resources
			existing : {
				resources : [],
				metadata  : [],
				data      : []
			},

			data : {
				title : '',
				name : '',
				notes : '',
				author : '',
				author_email : '',
				license_id : '',
				license_title : '',
				maintainer : '',
				maintainer_email : '',
				version : '',
				owner_org : '',
				tags : [],
				private : false,
				extras : []
			},
			owner_org_name : '',

			schema : [],
			wavelengths : [],

			datasetAttributes : {
				//group_by : '',
				sort_on : '',
				sort_type : '',
				sort_description : '',
				location : '',
			},

			// list of all new resources
			resources  : [],

			// hash of current attribute name mappings
			//  - key: ecosis name
			//  - value: dataset name
			attributeMap : {},
			// inverse list of above map w/ key / value switched
			inverseAttributeMap : {},

			metadataDefinitions : {},

			// this flag prevents up from making updates when we are initially
			// setting the data
			loaded : false,

			ready : function() {
				if( this.data.title == '' ) window.location.hash = '#basic-fields';
				this.metadataDefinitions = esis.schemaMap;
			},

			fireLoaded : function() {
				this.fire('load');
			},

			getDatasetExtra : function(key) {
				if( !this.data.extras ) return null;

				for( var i = 0; i < this.data.extras.length; i++ ) {
					if( this.data.extras[i].key == key ) return this.data.extras[i];
				}
				return null;
			},

			setDatasetExtra : function(key, value) {
				if( !this.data.extras ) this.data.extras = [];

				for( var i = 0; i < this.data.extras.length; i++ ) {
					if( this.data.extras[i].key == key ) {
						this.data.extras[i].value = value;
						return;
					}
				}

				this.data.extras.push({
					key : key,
					value : value
				});
			}
		});
	</script>
</polymer-element>
