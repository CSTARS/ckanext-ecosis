<dom-module id="ecosis-page-current-resources">
  <style>
    :host {
      display : block;
      padding: 0 10%;
    }
    #legend {
      padding: 20px 0;
    }
  </style>

  <template>

    <h4 class="page-header">Current Resources</h4>

    <div id="resourceRoot"></div>

    <div id="noResources" id="alert alert-warning" style="display:none">
      Your dataset does not contain any resource files.  Click the 'Add' tab to upload resources.
    </div>

    <div id="legend">
      <div style="float:right">
        Click the <i class="fa fa-pencil"></i> icon to inspect or edit a resource.
      </div>

      <h6 style="margin-bottom:0">Resource List Legend</h6>
      <span class="label label-success">Spectral Data File</span>
      <span class="label label-primary">Metadata File</span>
      <span class="label label-info">Zip Package</span>
      <span class="label label-default">Auxiliary File (Ignored)</span>
    </div>
  </template>
</dom-module>

<script>
  Polymer({
    is : 'ecosis-page-current-resources',

    ready : function() {
      if( ecosis.ds.loaded ) this.render();
      else ecosis.ds.on('load', this.render.bind(this));
    },

    render : function() {
      if( ecosis.ds.resources.length == 0 ) {
        this.$.noResources.style.display = 'block';
        this.$.legend.style.display = 'none';
        return;
      } else {
        this.$.noResources.style.display = 'none';
        this.$.legend.style.display = 'block';
      }

      var html = '';

      for( var i = 0; i < ecosis.ds.resources.length; i++ ) {
        var resource = ecosis.ds.resources[i];
        html += '<ecosis-resource-panel resourceid="'+resource.id+'"></ecosis-resource-panel>';
      }

      this.$.resourceRoot.innerHTML = html;
      /*
      <template repeat="{{r, i in ds.resources}}">
        <div class="card"
          metadata?="{{r.datasheets.length == 1 && r.datasheets[0].metadata}}"
          zip?="{{r.type == 'zip'}}">

          <template bind if="{{r.type == 'datafile' || r.type == 'zip'}}">
            <esis-ui-dataresource
              isSingleSheetMetadata="{{r.datasheets.length == 1 && r.datasheets[0].metadata}}"
              index="{{i}}"
              resource="{{r}}"
              on-remove="{{_deleteResource}}"
              on-datasheet-updated="{{clearMetadata}}">
            </esis-ui-dataresource>
          </template>

          <template bind if="{{r.type != 'datafile' && r.type != 'zip'}}">
            <span>{{r.resource.name}}</span>
            <esis-ui-delete-button index="{{i}}"
                      on-delete="{{_deleteGenericResource}}">
                  </esis-ui-delete-button>
                  <template bind if="{{r.removing}}">
                    <div>
                      <span style="color:red">Removing...</span>
                      <paper-progress indeterminate class="red"></paper-progress>
                    </div>
                  </template>
          </template>
        </div>
      </template>
      */
    }
  });
</script>
