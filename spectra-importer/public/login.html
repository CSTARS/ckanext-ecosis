<html>
<head>

	<link rel="stylesheet" href="/components/bootstrap/dist/css/bootstrap.min.css" >

	<script src="/components/jquery/dist/jquery.js"></script>

</head>
<body>

	<div class="row">
		<div class="col-md-6 col-md-offset-3">
			<h2>Login</h2>

			<div class="form-horizontal" role="form">
			  <div class="form-group">
			    <label for="username" class="col-sm-2 control-label">Username</label>
			    <div class="col-sm-10">
			      <input type="email" class="form-control" id="username" placeholder="Username">
			    </div>
			  </div>
			  <div class="form-group">
			    <label for="password" class="col-sm-2 control-label">Password</label>
			    <div class="col-sm-10">
			      <input type="password" class="form-control" id="password" placeholder="Password">
			    </div>
			  </div>
			  <div class="form-group">
			    <div class="col-sm-offset-2 col-sm-10">
			      <button id="submit" class="btn btn-default">Sign in</button>
			    </div>
			  </div>
			</div>

			<div id="error" class="alert alert-danger" style="display:none"></div>
		</div>
	</div>

	

	<script>
		$('#submit').on('click', function(){
			login();
		});
		$('#password').on('keypress', function(e){
			if( e.which == 13 ) login();
		});

		function login() {
			$('#submit').html('Signing in...').addClass('disabled');
			$.ajax({
				type : 'POST',
				url  : '/rest/login',
				data : {
					username : $('#username').val(),
					password : $('#password').val()
				},
				success : function(resp) {
					$('#submit').html('Sign in').removeClass('disabled');
					showError(resp);
					if( resp.success ) window.location = '/';
				},
				failure : function() {
					$('#submit').html('Sign in').removeClass('disabled');
					showError({error:true,message:'Unknown Error'});
				}
			})
		}

		function showError(resp) {
			if( resp.error ) {
				$('#error').show().html(resp.message);
			} else {
				$('#error').hide();
			}
		}
	</script>


</body>
</html>