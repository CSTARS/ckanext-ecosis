<html>
<head>
	<title>Test Page</title>

	<link rel="stylesheet" href="lib/bootstrap2/css/bootstrap.min.css">
	<link rel="stylesheet" href="lib/bootstrap2/css/bootstrap-responsive.min.css">
	<link rel="stylesheet" href="components/font-awesome/css/font-awesome.min.css">

	<script src="/components/jquery/dist/jquery.min.js"></script>
	<script src="lib/bootstrap2/js/bootstrap.min.js"></script>
	<script src="lib/jszip.js"></script>
	<script src="lib/xlsx.js"></script>
	<!--<script src="components/js-xlsx/dist/xlsx.min.js"></script>-->
	<script src="components/js-xls/dist/xls.min.js"></script>
	<script src="components/jquery-csv/src/jquery.csv.js"></script>
	<script src="components/js-md5/js/md5.min.js"></script>

	<script src="js/main.js"></script>
	<script src="js/extractor.js"></script>
	<script src="js/uploader.js"></script>
	<script src="js/extension.js"></script>
	<script src="js/parser.js"></script>
	<script src="js/existingData.js"></script>
	<script src="metadata.js"></script>

	<script src="js/structures/import.js"></script>
	<script src="js/structures/file.js"></script>
	<script src="js/structures/datasheet.js"></script>
	<script src="js/structures/resource.js"></script>
	<script src="js/structures/spectra.js"></script>
	<script src="js/structures/joinableMetadata.js"></script>

</head>
<body style="padding: 0 20px">

	<div id="shimRoot"></div>
	

<script type="text/javascript">
	// add jquery
	var head = document.getElementsByTagName("head")[0];

	// add visualization api
	var google = document.createElement("script");
	google.src = 'https://www.google.com/jsapi';


	esis.onGoogleLoad = function() {
		// callback is a dumby function that prevents loader from using document.write()
		google.load('visualization', '1.0', {callback: function(){},'packages':['corechart']});
	}

	google.onload = esis.onGoogleLoad;
	head.appendChild(google);
</script>

<style>
.drop-zone-container {
  text-align: center;
}

#drop_zone {
  border: 2px dashed #bbb;
  -moz-border-radius: 5px;
  -webkit-border-radius: 5px;
  border-radius: 5px;
  padding: 25px;
  text-align: center;
  font-size: 20pt;
  color: #bbb;
  background-color: white;
}

.help-block {
	font-size: 12px;
	margin-top: 0px !important;
	color: #999;
}

.card {
	margin: 10px;
	padding: 10px;
	background-color: white;
	border: 1px solid #ccc;
	overflow: hidden
}

.nav-panel {
	display: none;
}
</style>


<h1 style="color:#333;margin-bottom:25px"><i class="fa fa-cloud-upload"></i> Import Resources</h1>

<ul class="nav nav-pills" id="upload-nav">
  <li class="active"><a id="nav-spectra-start">Upload</a></li>
  <li>
  	<a id="nav-existing-spectra">Current Resources<span id="existing-count"></span></a>
  </li>
  <li style="display:none"><a id="nav-data-body">Parsed Spectra<span id="parsed-count"></span></a></li>
  <li style="display:none"><a id="nav-join-body">Join Data<span id="join-count"></span></a></li>
  <li style="display:none"><a id="nav-resources-body">New Resources<span id="resource-count"></span></a></li>
</ul>

<div class="nav-panel" id="existing-spectra"></div>

<div class="nav-panel" id="spectra-start">

	<div class="well" style="color:#666">
		<div class="form-horizontal">
		  <div class="control-group">
		    <label class="control-label" for="parseZip">Zip Files</label>
		    <div class="controls">
		      <label class="checkbox">
		      	<input type="checkbox" style="margin-top:5px" id="parseZip"> Extract
		  	  </label>
		      <span class="help-block">If a zip file is found, should its contents be imported as individual resources?  By default the spectra will be parsed, but the zip will be uploaded intact.</span>
		    </div>
		  </div>
		  <div class="control-group file-select-group">
		    <label class="control-label" for="inputEmail"><i class="fa fa-file"></i> Select File</label>
		    <div class="controls">
		      <input type="file" style="margin-top:5px" id="file" name="file" multiple>
		      <span class="help-block">Select a files to be imported.</span>
		    </div>
		  </div>
		  
		</div>
	    
	    <div class="file-select-group">
        	<h4 style="text-align:center">- OR -</h4>
        	<div id="drop_zone">Drop files here</div>
    	</div>

    	<h2 style="display:none;text-align:center" id="processing">Parsing... <br /><small>Please wait, this may take a moment.</small></h2>

        <div style="border-top:1px solid #ccc;padding-top:15px;margin-top:15px">
        	<h4>Metadata Map</h4>
        	<span class="help-block" id="metadata-map-block-help" style="display:none">If your metadata attribute names do not match <a>this</a> list, you can download this metadata map file.  Fill it out and upload in the box to the right.  You can reuse this file, so you only have to do it once for your data.</span>

        	<div class="row-fluid" id="metadata-map-block" style="display:none">
        		<div class="span6">
        			<a class="btn btn-default" target="_blank" href="/metadata_map">Download Map Template</a>
        		</div>
        		<div class="span6">
        			Upload Map: <input type="file" style="margin-top:5px" id="map" name="map">
        		</div>
        	</div>
	       	<div id="current-metadata-map"></div>

        </div>

        <div style="border-top:1px solid #ccc;padding-top:15px;margin-top:15px;display:none" id="unique-id">
        	<h4>Unique Identifier</h4>
        	<span class="help-block">Your spectra signatures for this dataset are not inherently unique.  Please provide a metadata field that can serve as a unique identifier.</span>

			<div class="form-horizontal">
			  <div class="control-group">
			    <label class="control-label" for="unique-id-input">Unique ID</label>
			    <div class="controls">
			      <select style="form-control" id="unique-id-input"></select>
			    </div>
			  </div>			  
			</div>
        </div>

	</div>

	<a class="btn btn-primary" id="addResources" style="display:none">Add Resources</div>
</div>

<div id="spectra-status" class="nav-panel">
	<a class="btn btn-default pull-right back">Back</a>
	<div id="spectra-status-content"></div>
	<a class="btn btn-default back">Back</a>
</div>


<div id="data-body" class="nav-panel">
	<div><a id="show-status" class="btn btn-default">Inspect</a></div>
	<div id="data-body-inner"></div>
</div>

<div id="join-body" class="nav-panel"></div>

<div id="resources-body" class="nav-panel"></div>


<!-- TODO
<h1>Example</h1>
<table class="table">
	<tr><td class="file-data">location</td><td class="file-data">38, -121</td><td></td><td></td></tr>
	<tr><td class="file-data">device</td><td class="file-data">asd</td><td></td><td></td></tr>
	<tr><td class="file-data">date</td><td class="file-data">2014-1-5</td><td></td><td></td></tr>
	<tr><td class="file-data"></td><td class="file-data"></td><td></td><td></td></tr>
	<tr style="height:40px"><td></td><td></td><td></td><td></td></td>
	<tr><td class="spectra-metadata"></td><td class="spectra-metadata"></td><td class="spectra-metadata"></td><td class="spectra-metadata"></td></tr>
	<tr><td class="spectra-metadata"></td><td class="spectra-metadata"></td><td class="spectra-metadata"></td><td class="spectra-metadata"></td></tr>
	<tr><td class="spectra-metadata"></td><td class="spectra-metadata"></td><td class="spectra-metadata"></td><td class="spectra-metadata"></td></tr>
	<tr><td class="spectra-data"></td><td class="spectra-data"></td><td class="spectra-data"></td><td class="spectra-data"></td></tr>
	<tr><td class="spectra-data"></td><td class="spectra-data"></td><td class="spectra-data"></td><td class="spectra-data"></td></tr>
	<tr><td class="spectra-data"></td><td class="spectra-data"></td><td class="spectra-data"></td><td class="spectra-data"></td></tr>
	<tr><td class="spectra-data"></td><td class="spectra-data"></td><td class="spectra-data"></td><td class="spectra-data"></td></tr>
</table>
-->

<div class="modal fade" id="Modal">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
    <h4 class="modal-title">File Info</h4>
  </div>
  <div class="modal-body" ></div>
  <div class="modal-footer">
    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
  </div>
</div><!-- /.modal -->

<script>
	esis.app.init();
</script>
	
</body>
</html>